import{S as me,i as ve,s as ge,e as _,a as x,t as Y,v as be,c as w,h as d,d as E,b as B,f as K,g as Z,j as y,w as C,l as v,k,n as L,o as oe,p as re,q as _e,r as we,u as ce,x as ke,y as Te}from"./index.BUYXiDtP.js";import{e as ue}from"./each.-gASlQSi.js";import{p as X,a as je}from"./index.CZM0Nrp8.js";const Se=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;let te=0,de=[];function xe(){return te+=1,()=>{if(te-=1,te===0){let e=de;de=[];for(let s of e)s()}}}function Ee(e){let s=xe();return e().finally(s)}X("atlas",{plugin:[]},{encode:JSON.stringify,decode:JSON.parse});const se=X("musicData",{items:[]},{encode:JSON.stringify,decode:JSON.parse}),W=X("tagSettings",{},{encode:JSON.stringify,decode:JSON.parse}),Oe=Ee(async()=>{const e=await fetch("/api/music.json");if(!e.ok)throw new Error("Failed to fetch music data");const s=await e.json();return se.set(s),s}),Pe=[{i:"a",x:0,y:0,w:4,h:16,moved:!1,static:!0},{i:"b",x:4,y:0,w:4,h:16,moved:!1,static:!0},{i:"c",x:8,y:0,w:4,h:16,moved:!1,static:!0},{i:"d",x:4,y:16,w:4,h:4,moved:!1,static:!1},{i:"e",x:4,y:8,w:4,h:4,moved:!1,static:!1},{i:"f",x:8,y:16,w:4,h:4,moved:!1,static:!1},{i:"g",x:4,y:12,w:4,h:4,moved:!1,static:!1},{i:"h",x:8,y:12,w:4,h:4,moved:!1,static:!1},{i:"i",x:0,y:16,w:4,h:4,moved:!1,static:!1},{i:"j",x:8,y:0,w:4,h:16,moved:!1,static:!1}];X("layoutKey",Pe,{encode:JSON.stringify,decode:JSON.parse});je("kbve:");const{document:fe}=Se;function he(e,s,c){const a=e.slice();return a[22]=s[c],a}function pe(e){let s,c=e[22]+"",a,f,m,T;function O(){return e[11](e[22])}return{c(){s=_("button"),a=Y(c),f=x(),this.h()},l(u){s=w(u,"BUTTON",{class:!0});var h=B(s);a=K(h,c),f=E(h),h.forEach(d),this.h()},h(){y(s,"class","relative z-1 px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500"),C(s,"opacity-100",e[4][e[22]]),C(s,"opacity-50",!e[4][e[22]])},m(u,h){k(u,s,h),v(s,a),v(s,f),m||(T=L(s,"click",O),m=!0)},p(u,h){e=u,h&16&&c!==(c=e[22]+"")&&oe(a,c),h&16&&C(s,"opacity-100",e[4][e[22]]),h&16&&C(s,"opacity-50",!e[4][e[22]])},d(u){u&&d(s),m=!1,T()}}}function Ne(e){let s,c,a,f,m,T,O,u,h,P,V,j,U="Sync",M,S,J="Skip",I,g,D=e[1]?"Disable Force Play":"Enable Force Play",z,A,N,q,b,t=`<p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web
    browser that
    <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>`,l,n,G="Currently Playing Video ID:",Q,H,$,ae,F=ue(Object.keys(e[4])),p=[];for(let o=0;o<F.length;o+=1)p[o]=pe(he(e,F,o));return{c(){s=_("link"),c=x(),a=_("div"),f=_("button"),m=Y("Play Tracks"),O=x(),u=_("button"),h=Y("Play Sets"),V=x(),j=_("button"),j.textContent=U,M=x(),S=_("button"),S.textContent=J,I=x(),g=_("button"),z=Y(D),A=x(),N=_("div");for(let o=0;o<p.length;o+=1)p[o].c();q=x(),b=_("video"),b.innerHTML=t,l=x(),n=_("strong"),n.textContent=G,Q=x(),H=Y(e[0]),this.h()},l(o){const r=be("svelte-1jkjurj",fe.head);s=w(r,"LINK",{href:!0,rel:!0}),r.forEach(d),c=E(o),a=w(o,"DIV",{class:!0});var i=B(a);f=w(i,"BUTTON",{class:!0});var R=B(f);m=K(R,"Play Tracks"),R.forEach(d),O=E(i),u=w(i,"BUTTON",{class:!0});var ie=B(u);h=K(ie,"Play Sets"),ie.forEach(d),V=E(i),j=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(j)!=="svelte-ecpas0"&&(j.textContent=U),M=E(i),S=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(S)!=="svelte-1cd9dc6"&&(S.textContent=J),I=E(i),g=w(i,"BUTTON",{class:!0});var ne=B(g);z=K(ne,D),ne.forEach(d),i.forEach(d),A=E(o),N=w(o,"DIV",{class:!0});var le=B(N);for(let ee=0;ee<p.length;ee+=1)p[ee].l(le);le.forEach(d),q=E(o),b=w(o,"VIDEO",{id:!0,class:!0,preload:!0,width:!0,height:!0,"data-svelte-h":!0}),Z(b)!=="svelte-12y7kzy"&&(b.innerHTML=t),l=E(o),n=w(o,"STRONG",{"data-svelte-h":!0}),Z(n)!=="svelte-1xwgl6o"&&(n.textContent=G),Q=E(o),H=K(o,e[0]),this.h()},h(){y(s,"href","https://unpkg.com/video.js/dist/video-js.min.css"),y(s,"rel","stylesheet"),y(f,"class",T="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(e[2]?"opacity-100":"opacity-50")),y(u,"class",P="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(e[3]?"opacity-100":"opacity-50")),y(j,"class","px-4 py-2 bg-blue-500 border text-white rounded hover:scale-110 ease-in-out duration-500"),y(S,"class","px-4 py-2 bg-red-500 text-white rounded hover:scale-110 ease-in-out duration-500"),y(g,"class","px-4 py-2 bg-cyan-600 border text-white rounded hover:scale-110 ease-in-out duration-500"),C(g,"opacity-100",e[1]),C(g,"opacity-50",!e[1]),y(a,"class","space-x-2 my-4"),y(N,"class","space-x-2"),y(b,"id","video-js"),y(b,"class","video-js vjs-default-skin w-full aspect-video"),b.controls=!0,y(b,"preload","auto"),y(b,"width","640"),y(b,"height","264")},m(o,r){v(fe.head,s),k(o,c,r),k(o,a,r),v(a,f),v(f,m),v(a,O),v(a,u),v(u,h),v(a,V),v(a,j),v(a,M),v(a,S),v(a,I),v(a,g),v(g,z),k(o,A,r),k(o,N,r);for(let i=0;i<p.length;i+=1)p[i]&&p[i].m(N,null);k(o,q,r),k(o,b,r),k(o,l,r),k(o,n,r),k(o,Q,r),k(o,H,r),$||(ae=[L(f,"click",e[8]),L(u,"click",e[9]),L(j,"click",e[7]),L(S,"click",e[5]),L(g,"click",e[10])],$=!0)},p(o,[r]){if(r&4&&T!==(T="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[2]?"opacity-100":"opacity-50"))&&y(f,"class",T),r&8&&P!==(P="px-3 py-1 text-sm font-medium border rounded-md hover:scale-110 ease-in-out duration-500 "+(o[3]?"opacity-100":"opacity-50"))&&y(u,"class",P),r&2&&D!==(D=o[1]?"Disable Force Play":"Enable Force Play")&&oe(z,D),r&2&&C(g,"opacity-100",o[1]),r&2&&C(g,"opacity-50",!o[1]),r&80){F=ue(Object.keys(o[4]));let i;for(i=0;i<F.length;i+=1){const R=he(o,F,i);p[i]?p[i].p(R,r):(p[i]=pe(R),p[i].c(),p[i].m(N,null))}for(;i<p.length;i+=1)p[i].d(1);p.length=F.length}r&1&&oe(H,o[0])},i:re,o:re,d(o){o&&(d(c),d(a),d(A),d(N),d(q),d(b),d(l),d(n),d(Q),d(H)),d(s),_e(p,o),$=!1,we(ae)}}}function Ve(e){return new URLSearchParams(window.location.search).get(e)}function ye(e){return/^[a-zA-Z0-9_-]{11}$/.test(e)}function De(e,s,c){let a,f;ce(e,W,t=>c(4,a=t)),ce(e,se,t=>c(15,f=t));let m,T=!1,O=!1,u="",h=!1,P=!0,V=!1;ke(()=>{O=!0,console.log("Mounted"),j().then(()=>{O&&T&&S()})}),Te(()=>{O=!1,m&&m.dispose()});async function j(){try{await new Promise((t,l)=>{const n=document.createElement("script");n.src="https://unpkg.com/video.js/dist/video.min.js",n.onload=t,n.onerror=()=>l(new Error("Failed to load Video.js")),document.head.appendChild(n)}),await new Promise((t,l)=>{const n=document.createElement("script");n.src="https://unpkg.com/videojs-youtube/dist/Youtube.min.js",n.onload=t,n.onerror=()=>l(new Error("Failed to load YouTube plugin")),document.head.appendChild(n)}),T=!0}catch(t){console.error("Error loading scripts:",t)}}async function U(){Oe.then(()=>{console.log("Music data has been successfully updated.")}).catch(t=>{console.error("Error updating music data:",t)})}function M(){const t={};f.items.forEach(l=>{l.tags.forEach(n=>{n!=="music"&&(t[n]=!0)})}),W.set(t)}async function S(){if(f.items.length===0)try{await U(),console.log("Music Data Loaded:",f.items)}catch(t){console.error("Failed to fetch music data:",t);return}Object.keys(a).length===0?(console.log("Initializing tags from music data..."),M()):console.log("Tags already initialized:",a),J()}function J(){if(typeof videojs<"u"&&videojs.getTech("youtube")){const t=Ve("yt"),l=I();if(l.length===0&&(!t||!ye(t)))return;const n=t&&ye(t)?t:l[Math.floor(Math.random()*l.length)];m=videojs("video-js",{techOrder:["youtube"],sources:[{type:"video/youtube",src:`https://www.youtube.com/watch?v=${n}`}],youtube:{iv_load_policy:3},controls:!0,autoplay:!0,preload:"auto"}),m.on("pause",()=>{}),m.on("ended",g),c(0,u=n)}else setTimeout(J,100)}function I(){let t=[];return f.items.forEach(l=>{l.tags.some(G=>a[G]===!0)&&(P&&(t=t.concat(l.ytTracks)),V&&(t=t.concat(l.ytSets)))}),t}function g(){const t=I();if(t.length===0)return;const l=t[Math.floor(Math.random()*t.length)];m.src({type:"video/youtube",src:`https://www.youtube.com/watch?v=${l}`}),m.play(),c(0,u=l)}function D(t){const l={...a,[t]:!a[t]};W.set(l)}async function z(){se.set({items:[]}),W.set({});try{await U(),M(),J(),console.log("Data and tags have been synchronized."),window.location.reload()}catch(t){console.error("Error during synchronization:",t)}}return[u,h,P,V,a,g,D,z,()=>c(2,P=!P),()=>c(3,V=!V),()=>c(1,h=!h),t=>D(t)]}class Ie extends me{constructor(s){super(),ve(this,s,De,Ne,ge,{})}}export{Ie as default};
